<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rankometer</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>

body, html {
    overflow-x: auto;  /* This will add a horizontal scrollbar if content overflows */
}

#player-names {
    text-indent: 10px;
}

#player-names::placeholder {
    text-indent: 10px;
}


* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}


        html, body {
    margin: 0;
    padding: 0;
    background-color: black;
        
}

        body {
    background-color: black;
}

#player-names, #search-button {
    margin-top: 0;
    margin-bottom: 0;
}

        svg {
    margin: 0;
}

#content-area, #yearly-ranks {
    margin-left: 0;  /* or any other value you want */
    padding-left: 0; /* or any other value you want */

    /* Other styles as needed */
}

#main-container {
    justify-content: flex-start;  /* This will align the children (search box and player info) to the left. */
    align-items: flex-start; 
    display: flex;
    width: 100%;
    box-sizing: border-box;
    margin-top: 0;
    margin-bottom: 0;
}



#search-container {
    padding: 5px;
    display: flex;
    align-items: center; 
    width: 400px;
    /* background-color: red;  for visualization purposes */ 
    margin-left: 40px;  /* or any other value you want */

}





#rankometer-header {
    font-size: 40px;  /* Adjust this value to your preferred font size */
    color: orange;
    margin-bottom: 5px;
    margin-top: 30px;
    padding-left: 0px;
}



#player-info {
    /* text-align: left;  // Ensures text inside is left-aligned. */
    width: calc(100% - 500px);
    /* background-color: blue;  for visualization purposes */
    position: absolute;
    top: -20px; /* Adjust this value as needed to control the overlap */
    left: 0;    /* Adjust if needed */
    color: orange;
    padding-left: 0px;

}


#player-info > * {
    margin-left: 50px;  /* adjust this value as needed */

}



#player-names {
    height: 40px;  
    padding: 0;  /* Remove padding */
    line-height: 40px;  /* Center the text vertically */    width: 250px; /* Adjusted width */
    border: 1px solid black; 
    outline: none; 
    color: gray; 
    border-radius: 0; /* Reset border-radius */
    font-size: 18px; /* Makes the text inside the box larger */

}

#search-button {
    display: flex;
    justify-content: center; /* Horizontally center the icon */
    align-items: center; /* Vertically center the icon */
    background-color: white;
    border: 1px solid black; 
    height: 40px; /* Match the height of the search box */
    width: 40px; /* Match the height of the search box */

    /* padding: 0 5px; Minimal horizontal padding */
}

#search-button img {
    height: 25px;  /* Slightly smaller to ensure it's centered */
    width: auto;
    margin: 0;

}




#player-names:focus {
    color: gray; /* Ensures text color remains gray when focused */
}




        
input[type="text"] {
    width: 400px; /* Adjust as needed */
    height: 50px; /* Adjust as needed */
    font-size: 24px; /* Makes the text inside the box larger */
    margin-left: 5%; /* Left-aligns the box with the rest of your content */
    margin-top: 30px; /* Pushes the search box down. Adjust this value as needed */
    background-color: white; /* Makes the search box white */
}



        footer {
     text-align: left;
    margin-left: 5%;
    background-color: 0;  /* This is a dark gray; adjust as desired */
}

        
#headshot {
    width: 100px;  /* Adjust based on the size of your headshot */
    border-radius: 50%;  /* Makes the image circular */
    margin-right: 20px;
    margin-left: 5%;

}

        
header {
    text-align: left;
    background-color: #000; /* Dark black background */
    padding-left: 20px; /* Left padding to ensure content doesn't stick to the edge */
    padding-top: 15px;  /* Increase this value for more height */
    padding-bottom: 15px;  /* Increase this value for more height */

}


/* Default styles for desktops and larger screens */
#content-area {
    position: relative;
    background-color: #000000;
    width: 1200px;  /* Set fixed width for desktops and larger screens */
    margin: 0 auto; /* This will center the container on the page */
    padding: 50px 0 0; /* Combined padding values */
    overflow-x: auto; /* Add horizontal scrolling if content overflows */
}

/* Override styles for smaller screens (e.g., smartphones) */
@media (max-width: 768px) {
    #content-area {
        width: 300px;  /* Set fixed width for smaller screens */
    }
}



#logo {
    width: 200px;  /* You can adjust this based on the desired size of your logo */
    margin-right: 50px; /* Space between the logo and any other content in the header */
        margin-left: 4%;
}

       
.year-column strong {
    font-size: 1.3em; /* Adjust this value to your desired font size */
    /* any other existing styles for this selector */
}

        #yearly-ranks {   /* Pushing the visualizations down */
    margin-top: 5vh;
    padding: 80px;
    background-color: black
}

  

        
body {
    background-color: #d1d0d0;
    color: black;
    font-family: 'Helvetica', sans-serif;
}

.player-name {
    color: #444444;
}

input, button {
    background-color: #8d0202;  /* Dark gray background */
    color: white;            /* White text */
    border: 1px solid white; /* White border */
}

        



        
.highlighted-player, .subsequent-player, .player-name {
    display: inline-block;
    margin-bottom: 3px;  /* Adjust as needed */
    text-align: center;
    line-height: 1.2;  /* Adjust as needed */
    width: 95%;
    padding: 2px 4.5px;  /* This ensures a consistent vertical size */

}




.highlighted-player, .subsequent-player {
    padding-left: 3px;  /* Decrease the left padding slightly */
    padding-right: 7px; /* Increase the right padding slightly */
    background-color: orange;
    color: black; /* Change the text color to black for better contrast against the orange background */

}



        .player-name {
    line-height: 1.2;
}

.year-column {
    width: 3.5=%;
    display: inline-block;
    vertical-align: top;
    font-size: 0.7em; /* Adjusting the font size */
    overflow: hidden;
    text-overflow: ellipsis;
    text-align: center;  /* Center-align content */
    margin-right: 10px;  /* Adjust this value based on the desired spacing */
    color: white;

}

#main-container > *, #content-area > * {
    margin-top: 0;
    margin-bottom: 0;

}

    </style>




</head>
<body>

<header>
    <img src="kevindamebaseball_logo.png" alt="Your Logo" id="logo">
</header>

 <!-- The parent flex container -->
<div id="main-container" style="display: flex; align-items: flex-start; justify-content: space-between; padding: 5px 20px;">

    <!-- Search box container -->
    <div id="search-container">
        <input id="player-names" type="text" placeholder=" Enter Player Name..." />
        <button id="search-button" type="button">
            <img src="search_icon.png" alt="Search">
        </button>
    </div>

   
</div>

<!-- Content area outside of main-container and player-info -->
<div id="content-area">
     <!-- Text section -->
     <div id="player-info">
        <h2 id="rankometer-header">Rankometer</h2>
        <p>Top 30 Players by WAR: <span id="years-active"></span></p>
    </div>
    <div id="yearly-ranks">
        <!-- Year columns will be appended here -->
    </div>
</div>



<script>

function adjustColumnStyles() {
    // Get all the year columns
    const yearColumns = document.querySelectorAll('.year-column');

    // Calculate the number of columns
    const columnCount = yearColumns.length;

    // Define your rules for adjusting width and font size based on column count
    let columnWidth = '5.5%';  // default width
    let fontSize = '0.7em';    // default font size

    if (columnCount <= 12) {
        columnWidth = '5.5%';
        fontSize = '0.7em';
    } else if (columnCount <= 18) {
        columnWidth = '4.7%';
        fontSize = '0.7em';
    } else if (columnCount <= 22) {
        columnWidth = '3.75%';
        fontSize = '0.7em';
    } else if (columnCount <= 24) {
        columnWidth = '3.4%';
        fontSize = '0.5em';
    } else if (columnCount <= 26) {
        columnWidth = '3.2%';
        fontSize = '0.4em';
    } else if (columnCount >= 28) {
        columnWidth = '2.75%';
        fontSize = '0.3em';
    }

    // Apply the styles to the year columns
    yearColumns.forEach(column => {
        column.style.width = columnWidth;
        column.style.fontSize = fontSize;
    });
}


function fetchPlayerData(playerName, csvFileName) {
    Papa.parse(csvFileName, {
        download: true,
        header: true,
        complete: function(data) {
            $("#yearly-ranks").empty();

            // Extracting start and end year
            const years = $('#years-active').text().match(/\d{4}/g);
            const startYear = parseInt(years[0]);
            const endYear = parseInt(years[1]);

            // Determine the last name to search for, considering the "Jr." scenario
            let playerNameParts = playerName.split(" ");
            let searchedLastName;
            if (playerNameParts[playerNameParts.length - 1].toLowerCase() === "jr.") {
                searchedLastName = playerNameParts[playerNameParts.length - 2].toLowerCase();
            } else {
                searchedLastName = playerNameParts[playerNameParts.length - 1].toLowerCase();
            }

            for(let year = startYear; year <= endYear; year++) {
                const playersOfYear = data.data.filter(p => p.Year == year);
                playersOfYear.sort((a, b) => parseFloat(b.WAR) - parseFloat(a.WAR));

                const top30Players = playersOfYear.slice(0, 30).map(p => {
                    let nameParts = p['Player Name'].split(' ');
                    if (nameParts[nameParts.length - 1].toLowerCase() === "jr.") {
                        return nameParts[nameParts.length - 2]; // Return the second-to-last word if the last word is "Jr."
                    }
                    return nameParts[nameParts.length - 1]; // Otherwise, return the last word
                });

                let columnHtml = `<div class="year-column">`;
                let highlightFound = false;

                for(const player of top30Players) {
                    if (player.toLowerCase() === searchedLastName) {
                        columnHtml += `<span class="highlighted-player">${player}</span><br>`;
                        highlightFound = true;
                    } else if (highlightFound) {
                        columnHtml += `<span class="subsequent-player">${player}</span><br>`;
                    } else {
                        columnHtml += `<span class="player-name">${player}</span><br>`;
                    }
                }

                columnHtml += `<strong>${year}</strong><br>`;
                columnHtml += '</div>';
                $("#yearly-ranks").append(columnHtml);
            }

            // Call the adjustColumnStyles function here, after the loop has completed
            adjustColumnStyles();
        }
    });
}



function searchPlayer(playerName) {
    Papa.parse('all_players.csv', {
        download: true,
        header: true,
        complete: function(allPlayersData) {
            const playersWithName = allPlayersData.data.filter(p => p['Player Name'] && p['Player Name'].toLowerCase() === playerName.toLowerCase());

            if (playersWithName.length > 0) {
                playersWithName.sort((a, b) => {
                    const aYears = a.Years.match(/\d{4}/g) || [];
                    const bYears = b.Years.match(/\d{4}/g) || [];
                    return (bYears[1] - bYears[0]) - (aYears[1] - aYears[0]);
                });

                const player = playersWithName[0];
                $('#years-active').text(player.Years.replace('+ (', ''));
                $('#rankometer-header').text(`Rankometer for ${playerName}`);

                // Fetch data from both CSVs and determine which one to use based on the frequency of the player's name.
                let pitcherCount = 0;
                let hitterCount = 0;

                Papa.parse('baseball_pitchers_1900_2024.csv', {
                    download: true,
                    header: true,
                    complete: function(pitchersData) {
                        pitcherCount = pitchersData.data.filter(p => p['Player Name'] && p['Player Name'].toLowerCase() === playerName.toLowerCase()).length;

                        Papa.parse('baseball_hitters_1900_2024.csv', {
                            download: true,
                            header: true,
                            complete: function(hittersData) {
                                hitterCount = hittersData.data.filter(p => p['Player Name'] && p['Player Name'].toLowerCase() === playerName.toLowerCase()).length;

                                // Choose the CSV where the player appears most frequently.
                                if (pitcherCount >= hitterCount) {
                                    fetchPlayerData(playerName, 'baseball_pitchers_1900_2024.csv');
                                } else {
                                    fetchPlayerData(playerName, 'baseball_hitters_1900_2024.csv');
                                }
                            }
                        });
                    }
                });
            } else {
                console.warn(`Player "${playerName}" not found in all_players.csv.`);
            }
        },
        error: function(error) {
            console.error('Error accessing all_players CSV:', error);
        }
    });
}



    
$('#search-button').click(function() {
    const playerName = $('#player-names').val();
    searchPlayer(playerName);
});

    // Set default player visual for Babe Ruth
document.addEventListener("DOMContentLoaded", function() {
    searchPlayer('Babe Ruth');
});


   
</script>

    <footer>
    <img src="headshot.png" alt="Your Headshot" id="headshot">
    <p>Your Name and any other info you want here</p>
</footer>

</body>
</html>
